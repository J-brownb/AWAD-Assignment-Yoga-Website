let dropdown=document.getElementById("dropdownmenu"),menuItems=document.getElementById("menuitems"),url=(dropdown.addEventListener("click",function(){menuItems.style.display="block"}),dropdown.addEventListener("mouseleave",function(){menuItems.style.display="none"}),"https://maps.googleapis.com/maps/api/place/textsearch/json?key=AIzaSyC7P5F4fU_8w3YnUjDD52aKz64Xk9vLn5w&query=yoga-studios-in-ipswich");function displayResults(url){fetch(url).then(response=>response.json()).then(function(results){for(let i=0;i<results.results.length;i++){let rating=results.results[i].rating;0==rating?rating="":rating<=1?rating="⭐":rating<=2?rating="⭐⭐":rating<=3?rating="⭐⭐⭐":rating<=4?rating="⭐⭐⭐⭐":rating<=5&&(rating="⭐⭐⭐⭐⭐");var all="<li>"+`<strong>${results.results[i].name} `+"</strong><br><br>"+results.results[i].formatted_address+" <br><br>"+`This studio is rated ${results.results[i].rating}/5 based on ${results.results[i].user_ratings_total} reviews`+"<br>"+rating+"</li>";document.getElementById("results").innerHTML+=all}var intro=document.getElementById("intro"),text=`We found ${results.results.length} `;intro.insertAdjacentText("afterbegin",text)})}function initMap(){let lat=[],lng=[];!function(url){fetch(url).then(response=>response.json()).then(function(results){for(let i=0;i<results.results.length;i++){lat.push(results.results[i].geometry.location.lat),lng.push(results.results[i].geometry.location.lng);var content="<div style = 'width:200px;min-height:40px'><strong>"+results.results[i].name+"</strong><br>"+results.results[i].formatted_address+" </div>";!function(lat,lng){let marker=new google.maps.Marker({position:lat,lng:lng,map:map,title:"Click to find out more 🔍"});const infowindow=new google.maps.InfoWindow({content:infoBox});marker.addListener("click",()=>{activeWindow&&activeWindow.close(),map.setZoom(14),map.setCenter(marker.getPosition()),infowindow.open({anchor:marker,map:map}),activeWindow=infowindow})}({lat:lat[i],lng:lng[i]},infoBox=content)}})}(url);let map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:52.0567,lng:1.1482}}),activeWindow}dropdown.addEventListener("mouseleave",function(){menuItems.style.display="none"}),displayResults(url);let loadingIcon=`<div class="d-flex justify-content-center" id="spinner">
<div class="spinner-border" role="status">
  <span class="sr-only">Loading...</span>
</div>
</div>`,loading=document.getElementById("spinner"),weatherUrl=(loading.innerHTML=loadingIcon,"https://weather.visualcrossing.com/VisualCrossingWebServices/rest/services/timeline/ipswich?unitGroup=metric&key=SNJXA2TKPSX2QQLTQTH6SS6LY&contentType=json");function weatherCall(count,divID,iCount){fetch(weatherUrl).then(response=>response.json()).then(data=>{document.getElementById(divID);for(let i=iCount;i<count;i++){var sunriseShort=(""+data.days[i].sunrise).slice(0,5),sunsetShort=(""+data.days[i].sunset).slice(0,5),sunriseShort='<li><div class ="date"><h3>'+data.days[i].datetime+"</h3></div><strong>"+data.days[i].conditions+"</strong><br><br>"+`<img src=/images/${data.days[i].icon}.png width="50" height="50">`+"<br><br>"+`🌡️ ${data.days[i].temp}c`+" |"+` 🌧️ ${data.days[i].precipprob}%`+" |"+`💨 ${data.days[i].windspeed}mph`+"<br>"+`☀️ ${sunriseShort}AM`+" |"+`🌕 ${sunsetShort}PM`+"<hr>"+data.days[i].description+"<br></li>";divID.innerHTML+=sunriseShort,loading.innerHTML=""}})}function dailySummary(){fetch(weatherUrl).then(response=>response.json()).then(data=>{document.getElementById(weeklysummary),document.getElementById(summary);var summaryText="Today's forecast is expected to be: "+data.days[0].description+"<br><br>"+`There is a ${data.days[0].precipprob}% chance of rain today, the temperature will be ${data.days[0].temp}c and the windspeed will be  ${data.days[0].windspeed}mph`;summary.innerHTML+=summaryText,weeklysummary.innerHTML=""+data.description})}weatherCall(7,weather,1),weatherCall(1,single,0),dailySummary();